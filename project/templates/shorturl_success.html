{% load socialaccount %}
<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Document</title>
    <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.3.1/css/bootstrap.min.css" integrity="sha384-ggOyR0iXCbMQv3Xipma34MD+dH/1fQ784/j6cY/iJTQUOhcWr7x9JvoRxT2MZw1T" crossorigin="anonymous">
    <style>
        body {
            background:#0e153a;
            color:#FFFFFF;
            font-family:
        }
        .url-container{
            /* border: 2px solid blue; */
            margin-left:20%;
            margin-right:20%;
        }
        table {
            font-family: arial, sans-serif;
            border-collapse: collapse;
            width: 90%;
            margin-left: auto;
            margin-right: auto;
            color:#FFFFFF;
        }
        
        td, th {
            border: 2px solid #FFFFFF;
            border-radius: 2px;
            text-align: center;
            padding: 1px;
        }
        
        tr:nth-child(even) {
            background-color: #0e153a;
        }
    </style>
</head>
<body>
    
    
    <div class="url-container">
        {% if user.is_authenticated %}
        <p>Welcome {{ user.username }} !!!</p>
        {% endif %}
        {% if not user.is_authenticated %}
        <a href="{% provider_login_url 'github' %}">Sign Up</a>
        {% endif %}
        <h1>Welcome to News Bytes Url Shortner Service</h1>
        <h4>Your given URL - {{given_url}} </h4>
        <h4 id="item-to-copy">Short Url - {{short_url}} <span><button onclick="copyToClipboard()">Copy</button></span></h4>
        
        <p>Want to create another - </p>
        <form action="/nbapp/short_url/" method="post">
            <label for="entered_url">Enter your URL </label>
            <input id="entered_url" type="text" name="entered_url" value="{{ current_url }}">
            <input type="submit" value="Submit">
        </form>
        <h4>Short Urls created by You - </h4>
    </div>
    <table>
        <tr>
            <th>#</th>
            <th>Original Url</th>
            <th>Short Url</th>
            <th>Clicked</th>
            <th>Created On</th>
        </tr>
        {% for each in created_urls %}
            <tr>
                <td>{{each.pk}}</td>
                <td>{{each.fields.full_url}}</td>
                <td>{{base_url}}{{each.fields.url_hash}}</td>
                <td>{{each.fields.clicks}}</td>
                <td>{{each.fields.created_at}}</td>
            </tr>
        {% endfor %}
    </table>
    <script>
        function copyToClipboard() {
            const str = document.getElementById('item-to-copy').innerText;
            const el = document.createElement('textarea');
            el.value = str;
            el.setAttribute('readonly', '');
            el.style.position = 'absolute';
            el.style.left = '-9999px';
            document.body.appendChild(el);
            el.select();
            document.execCommand('copy');
            document.body.removeChild(el);
        }
        
    </script>
</body>
</html>